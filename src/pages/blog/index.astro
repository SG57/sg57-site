---
import Base from '../../layouts/Base.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog'))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
---

<Base title="Blog â€” SG57 Labs" description="Engineering notes, product announcements, and deep dives from SG57 Labs.">
  <section class="blog-index container">
    <header class="blog-index__header">
      <h1 class="blog-index__title">BLOG</h1>
      <p class="blog-index__subtitle">Engineering notes, product announcements, and deep dives</p>
    </header>

    <ul class="blog-index__list">
      {posts.map((post) => {
        const formattedDate = post.data.date.toLocaleDateString('en-US', {
          year: 'numeric',
          month: 'short',
          day: 'numeric',
        });
        return (
          <li class="blog-index__item">
            <a href={`/blog/${post.id}`} class="blog-index__link">
              <time class="blog-index__date" datetime={post.data.date.toISOString()}>
                {formattedDate}
              </time>
              <h2 class="blog-index__post-title">{post.data.title}</h2>
              <p class="blog-index__desc">{post.data.description}</p>
              <div class="blog-index__tags">
                {post.data.tags.map((tag) => (
                  <span class="blog-index__tag">{tag}</span>
                ))}
              </div>
            </a>
          </li>
        );
      })}
    </ul>

    {posts.length === 0 && (
      <p class="blog-index__empty">No posts yet. Check back soon.</p>
    )}
  </section>
</Base>

<style>
  .blog-index {
    padding-top: 3rem;
    padding-bottom: 4rem;
    max-width: 720px;
  }

  .blog-index__header {
    margin-bottom: 2.5rem;
    padding-bottom: 1.5rem;
    border-bottom: 1px solid var(--sg57-border);
  }

  .blog-index__title {
    font-family: var(--sg57-font-display);
    font-size: 2rem;
    font-weight: 700;
    color: var(--sg57-accent);
    letter-spacing: 0.15em;
    margin-bottom: 0.5rem;
  }

  .blog-index__subtitle {
    font-size: 1rem;
    color: var(--sg57-text-dim);
  }

  .blog-index__list {
    list-style: none;
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: 0;
  }

  .blog-index__item {
    border-bottom: 1px solid var(--sg57-border);
  }

  .blog-index__link {
    display: block;
    padding: 1.5rem 0;
    text-decoration: none;
    transition: opacity 0.2s ease;
  }

  .blog-index__link:hover {
    opacity: 0.85;
  }

  .blog-index__date {
    font-family: var(--sg57-font-mono, monospace);
    font-size: 0.8125rem;
    color: var(--sg57-text-muted);
    display: block;
    margin-bottom: 0.375rem;
  }

  .blog-index__post-title {
    font-family: var(--sg57-font-display);
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--sg57-text);
    margin-bottom: 0.375rem;
    line-height: 1.3;
  }

  .blog-index__desc {
    font-size: 0.9375rem;
    color: var(--sg57-text-dim);
    line-height: 1.5;
    margin-bottom: 0.5rem;
  }

  .blog-index__tags {
    display: flex;
    gap: 0.375rem;
    flex-wrap: wrap;
  }

  .blog-index__tag {
    font-family: var(--sg57-font-mono, monospace);
    font-size: 0.6875rem;
    padding: 0.0625rem 0.375rem;
    background: var(--sg57-elevated);
    border: 1px solid var(--sg57-border);
    border-radius: 3px;
    color: var(--sg57-accent);
  }

  .blog-index__empty {
    text-align: center;
    color: var(--sg57-text-muted);
    padding: 3rem 0;
    font-style: italic;
  }
</style>
